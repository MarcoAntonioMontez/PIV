%calcR_T_svd

function [R, T] = calcR_T_svd(A_menos_centroid, B_menos_centroid, Centroid1, Centroid2) 
    %Subtract centroids from A,B
    A_menos_centroid_ = A_ - repmat(Centroid1_,1,Max);
    B_menos_centroid_ = B_ - repmat(Centroid2_,1,Max);

    %Compute SVD
    M = B_menos_centroid*A_menos_centroid';
    [U,~,V] = svd(M);
    Mdiagonal = ones(size(U',1),1);
    Mdiagonal(size(U',1),1) = det(U*V');
    R = U * (diag(Mdiagonal)) * V';
    T=Centroid2-R*Centroid1;
end